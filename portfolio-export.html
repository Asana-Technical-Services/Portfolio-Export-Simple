<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <form onsubmit="return false" id="mainform">
      <h2>Asana Portfolio to CSV export tool</h2>
      <details style="display: block">
        <summary><b>Instructions</b></summary>
        <p>
          This tool is used to generate a CSV of project records, including
          their custom fieds, from a nested portfolio structure in Asana.
        </p>
        <p>
          To use this tool, you'll need a <b>personal access token</b> and a
          <b>link to the top-level portfolio</b> you'd like to export.
        </p>
        <p><b>Personal Access Token:</b></p>
        <p>
          To generate your own personal access token, navigate to
          <a target="_blank" href="https://app.asana.com/-/developer_console"
            >https://app.asana.com/-/developer_console</a
          >
          and use the buttons at the bottom of the page to generate a new
          personal access token.
        </p>
        <p>
          <b>Treat this token like a password!</b> It allows programmatic access
          to Asana as you, so it's best saved in a password manager or private
          vault. If you have any reason to think a token may have been
          compromised, you can reset it or delete it in the developer console at
          <a target="_blank" href="https://app.asana.com/-/developer_console"
            >https://app.asana.com/-/developer_console</a
          >
        </p>
        <p><b>Portfolio Link:</b></p>
        <p>
          To get your portfolio link, simply navigate to your portfolio in
          Asana, copy the url from the URL bar, or use the "v" carrot menu next
          to the portfolio name and select "copy portfolio link". The resulting
          link should look like "https://app.asana.com/0/portfolio/12345/list"
        </p>
        <br />
        <p>
          Enter these details in the form below, and a CSV file will be
          generated to download. You may be prompted to approve or allow
          downloads from this page.
        </p>
        <p>
          Note that you'll only be able to export projects and portfolios that
          you have access to and can view in Asana.
        </p>
      </details>
      <div class="input-block">
        <label for="pat">Personal Access Token</label>
        <input
          id="pat"
          autocomplete="current-password"
          name="Personal Access Token"
          type="password"
          required
        />
      </div>
      <div class="input-block">
        <label for="pat">Portfolio</label>
        <input type="text" id="portfolio" required />
      </div>
      <div class="input-block">
        <input
          id="submit"
          type="submit"
          value="Get Portfolio"
          onclick="runExport()"
        />
      </div>
      <div id="errorbox"></div>
      <div class="lds-spinner" id="lds-spinner">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
    </form>
  </body>
  <script src="./index.js"></script>
</html>
